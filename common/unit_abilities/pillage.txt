pillage = {

	duration = 0
	enable = yes
	toggle = no
	army_only = yes
	
	map = yes

	hidden = {
		NOT  ={
			unit_owner = { 
				government = tribal_chiefdom 
				government = nomadic_tribe 				
			}
		}
	}
	
	allow = {
		is_army = yes
		in_combat = no
		is_moving = no
		in_siege = no
		is_exiled = no
		hidden:unit_location = {
			has_owner = yes
			civilization_value > 20
			total_population > 5
		}
		NOR = {
			hidden:unit_location = { 
				has_province_modifier = province_pillaged
			}
			hidden:unit_location = { 
				has_province_modifier = province_razed_ua
			}
			hidden:unit_location = { 
				owner = root.unit_owner 
			}
		}
		trigger_if = {
			limit = {
				exists = commander
			}
			commander = {
				loyalty > 33
			}
		}
		trigger_if = {
			limit = {
				unit_location = {
					exists = owner
					fort_level >= 1
				}
			}
			controller = root.unit_owner
		}
	}
	
	start_effect = {
		unit_location = {
			if = {
				limit = {
					exists = owner
				}
				owner = {
					if = {
						limit = {
							NOT = {
								war_with = root.unit_owner
							}
						}
						if = {
							limit = {
								opinion = {
									target = root.unit_owner
									value >= -100
								}
							}
							add_opinion = {
								modifier = opinion_we_pillaged_them
								target = root.unit_owner
							}
						}
						else = {
							root.unit_owner = {
								declare_war_with_wargoal = {
									war_goal = raiding_wargoal
									target = prev
								}
							}
						} 
					}
				}
			}
		}
		unit_owner = {
			add_political_influence = {
				value = root.unit_location.total_population
				multiply = root.unit_location.civilization_value
				divide = 100
				floor = 1
				min = 1
			}
		}
		
		unit_location = {
			add_province_modifier = {
				name = province_pillaged
				duration = 1825
			}
		}
		unit_location.owner = {
			add_opinion = {
				modifier = pillaged_us_opinion
				target = root.unit_owner
			}
		}
		unit_owner = {
			add_treasury = {
				value = {
					value = root.unit_location.total_population
					max = root.unit_size
				}
				multiply = 2
			}
		}
		unit_location = {
			add_city_smoke_effect = yes
		}
	}
	
	idle_entity_state = raiding
}