namespace = sorc_nova

sorc_nova.1 = {
    type = country_event
    title = sorc_nova.1.t
    desc = sorc_nova.1.desc
    picture = greek_city_market
    
    left_portrait = current_ruler

    trigger = {}

    immediate = {
    	ordered_owned_province = {
    		order_by = total_population
    		limit = {
    			OR = {
					is_in_region = rohevia_region
					is_in_region = rohenoa_shout_region
					is_in_region = rohenoa_central_region
					is_in_region = rohenoa_north_region
				}
    		}
    		max = 1
    		save_scope_as = barlaria_nova_capital
    	}
    }

    option = {      
        name = sorc_nova.1.a
        if = {
        	limit = {
        		any_subject = {
    				is_ai = no
    				any_owned_province = {
    					OR = {
    						is_in_region = rohevia_region
    						is_in_region = rohenoa_shout_region
							is_in_region = rohenoa_central_region
							is_in_region = rohenoa_north_region
    					}
    				}		
    			}
        	}
        	custom_tooltip = sorc_nova.1.a.tt_player
        }
        else = {
        	custom_tooltip = sorc_nova.1.a.tt
        }
        current_ruler = {
        	add_popularity = popularity_medium
        }
        hidden_effect = {
        	if = {
        		limit = {
        			any_subject = {
        				is_ai = no
        				any_owned_province = {
        					OR = {
	    						is_in_region = rohevia_region
	    						is_in_region = rohenoa_shout_region
							is_in_region = rohenoa_central_region
							is_in_region = rohenoa_north_region
	    					}

        				}		
        			}
        		}
        		random_subject = {
        			limit = {
        				is_ai = no
        				any_owned_province = {
        					OR = {
	    						is_in_region = rohevia_region
	    						is_in_region = rohenoa_shout_region
								is_in_region = rohenoa_central_region
								is_in_region = rohenoa_north_region
	    					}
        				}	
        			}
        			save_scope_as = barlaria_nova_scope
        			current_ruler = { save_scope_as = carthago_nova_ruler }
        			scope:barlaria_nova_scope = {
						change_country_name = "BARLARIA_NOVA_NAME"
						change_country_adjective = "BARLARIA_NOVA_ADJECTIVE"
						change_country_tag = BRL
						change_country_flag = BARLARIA_NOVA_FLAG
						change_country_color = navy_blue
        			}
        		}
        	}
        	else = {
				scope:barlaria_nova_capital = {
					create_country = {
						name = {
							name = "BARLARIA_NOVA_NAME"
							adjective = "BARLARIA_NOVA_ADJECTIVE"
						}
						save_scope_as = barlaria_nova_scope
						change_country_tag = BRL
						change_country_flag = BARLARIA_NOVA_FLAG
						change_country_color = navy_blue
						set_primary_culture = orcish_1
						set_country_religion = orcish_ancestral_faith
						change_government = oligarchic_republic
						add_treasury = 50.0
					}
				}
			}
			every_owned_province = {
				limit = {
					OR = {
						is_in_region = rohevia_region
						is_in_region = rohenoa_shout_region
						is_in_region = rohenoa_central_region
						is_in_region = rohenoa_north_region
					}
				}
				set_conquered_by = scope:barlaria_nova_scope
			}
			if = {
				limit = {
					NOT = { is_subject_of = root }
				}
				make_subject = { # Make Colony of Barlaria
					target = scope:barlaria_nova_scope
					type = subject_colony
				}
			}
    	}
	}
}