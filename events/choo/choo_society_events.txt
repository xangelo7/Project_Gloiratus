namespace = society_choo

society_choo.1 = {
	type = country_event
	title = "society_choo.1"
	desc = "society_choo.1"
	hidden = yes
	
	trigger = {	
		always = no
		has_variable = society_points	
	}

	immediate = {  	
		#society points gain	
		change_variable = { name = society_points add = 12 }	
		if = { limit = { has_variable = warmongering_nation_nature days_since_last_war > 2920 } change_variable = { name = society_points add = -6 }  }
		if = { limit = { has_variable = warmongering_nation_nature } change_variable = { name = society_points add = society_points_from_slaves } }
		#on battle won +1
		#on province rized +3
		#on war declared +6
		if = { limit = { has_variable = pacifist_nation_nature  days_since_last_war < 183 } change_variable = { name = society_points add = -6 }  }
		if = { limit = { has_variable = pacifist_nation_nature any_country = { alliance_with = ROOT }  } change_variable = { name = society_points add = 1 }  }
		if = { limit = { has_variable = pacifist_nation_nature OR = { diplomatic_stance = neutral_stance diplomatic_stance = appeasement_stance } } change_variable = { name = society_points add = 1 }  }
		if = { limit = { has_variable = pacifist_nation_nature all_non_slave_pops_average_happines > 50  } change_variable = { name = society_points add = 2 } }	
		#triggered society bonuses
		#might starter
		if = { limit = { has_variable = mightfull_society_starter any_neighbour_country = { count = all total_armed_units_count < root.total_armed_units_count  } } add_country_modifier = { name = mighty_power_morale duration = -1 } }
		else = { remove_country_modifier = mighty_power_morale }
		#ruthless rules
		if = { limit = { has_variable = ruthless_rules } 
		if = { limit = { tyranny >= 25 tyranny < 50 } add_country_modifier = { name = ruthlessness_rules_1 duration = -1 } remove_country_modifier = ruthlessness_rules_2 remove_country_modifier = ruthlessness_rules_3 } 
		else_if = { limit = { tyranny >= 50 tyranny < 75 } add_country_modifier = { name = ruthlessness_rules_2 duration = -1 } remove_country_modifier = ruthlessness_rules_1 remove_country_modifier = ruthlessness_rules_3  }
		else_if = { limit = { tyranny >= 75 } add_country_modifier = { name = ruthlessness_rules_3 duration = -1 } remove_country_modifier = ruthlessness_rules_1 remove_country_modifier = ruthlessness_rules_2 }
		else = { remove_country_modifier = ruthlessness_rules_1 remove_country_modifier = ruthlessness_rules_2 remove_country_modifier = ruthlessness_rules_3 }	
		}
		else = { remove_country_modifier = ruthlessness_rules_1 remove_country_modifier = ruthlessness_rules_2 remove_country_modifier = ruthlessness_rules_3 }
		#bound them all
		if = { limit = { has_variable = bound_by_common_tides root.current_ruler.corruption >= 20 } add_country_modifier = { name = bound_by_common_tides_society duration = -1 } }
		else = { remove_country_modifier = mighty_power_morale }	
	}
}
#rage mechanics
society_choo.2 = {
	type = country_event
	hidden = yes
	
	trigger = {
		OR = {
			government = berserkers_tribe
			has_variable = wrath_might
		}
	}

	immediate = {  	
		if = { limit = { NOT = { has_variable = rage_points_level } }  set_variable = { name = rage_points_level value = 0 } }	
		#scales up to 1 point if not at war
		if = { limit = { war = no }  change_variable = { name = rage_points_level add = 0.5 } }
		if = { limit = { war = no var:rage_points_level >= 25 }  change_variable = { name = rage_points_level add = 1 } }
		if = { limit = { war = no var:rage_points_level >= 50 }  change_variable = { name = rage_points_level add = 1.5 } }
		if = { limit = { war = no var:rage_points_level >= 75 }  change_variable = { name = rage_points_level add = 2 } }
		#scales down 
		if = { limit = { war = yes } change_variable = { name = rage_points_level add = -1 } }
		if = { limit = { war = yes var:rage_points_level >= 25 }  change_variable = { name = rage_points_level add = -1 } }
		if = { limit = { war = yes var:rage_points_level >= 50 }  change_variable = { name = rage_points_level add = -1 } }
		if = { limit = { war = yes var:rage_points_level >= 75 }  change_variable = { name = rage_points_level add = -2 } }	
		set_proper_rage_modifier = yes	
		if = {	
			limit = { 
				var:rage_points_level >= 100 
				government = berserkers_tribe 
			} 	
			random_character = { limit = { is_clan_chief = yes }  save_temporary_scope_as = breserkers_leader   }	
			random_province = { limit = { is_capital = no } save_temporary_scope_as = civilwar_starting_point  }	
			create_unit = {
				commander = scope:breserkers_leader
				sub_unit = berserkers
				location = scope:civilwar_starting_point
			}	
			scope:civilwar_starting_point = {
				while = {
					count = 5
					every_unit_in_province = {	
						add_subunit = berserkers	
					}	
				}	
			}
			start_civil_war = scope:breserkers_leader
			change_variable = { name = rage_points_level add = -75 }
		}
		if = {	
			limit = { 
				var:rage_points_level >= 100 
				NOT = { government = berserkers_tribe }  
			} 	
			random_character = { 
				limit = { 
					OR = { 
						is_governor = yes 
						has_any_office = yes 
					} 
				}  
				save_temporary_scope_as = breserkers_leader   
			}	
			create_unit = {
				commander = scope:breserkers_leader
				sub_unit = berserkers
				location = scope:civilwar_starting_point
			}
			scope:civilwar_starting_point = {
				while = {
					count = 5
					every_unit_in_province = {	
						add_subunit = berserkers
					}
				}
			}
			start_civil_war = scope:breserkers_leader
			change_variable = { name = rage_points_level add = -100 }
		}
		clamp_variable = { name = rage_points_level max = 100 min = 0 }
	}	
}

society_choo.3 = {
	type = country_event
	hidden = yes

	trigger = {  
		NOT = { 
			government = berserkers_tribe
			has_variable = wrath_might 
		}
		has_rage_modifier = yes
	}
	
	immediate = { 
	remove_all_rage_modifiers = yes
	}	
}
# domenese size set
society_choo.4 = {
	type = country_event
	title = "society_choo.3"
	desc = "society_choo.3"
	hidden = yes

	trigger = {
		government = feudal_monarchy
		OR = {
			AND = { 
				current_domene_size <= domene_size_value 
				OR = { 
					has_country_modifier = overextended_domene_size_1  
					has_country_modifier = overextended_domene_size_2 
					has_country_modifier = overextended_domene_size_3 
				} 
			} 
			current_domene_size > domene_size_value
			current_domene_size > domene_size_overextension_high
			current_domene_size > domene_size_overextension_very_high
		}	
	}

	immediate = {  
		if = {
			limit = { current_domene_size > domene_size_value }
			remove_domene_overextension_debuff = yes
			add_country_modifier = { name = overextended_domene_size_1  duration = -1 hidden = yes }	
		}
		else_if = { 
			limit = { current_domene_size > domene_size_overextension_high }
			remove_domene_overextension_debuff = yes	
			add_country_modifier = { name = overextended_domene_size_2  duration = -1 hidden = yes }
		}
		else_if = { 
			limit = { current_domene_size > domene_size_overextension_very_high }	
			remove_domene_overextension_debuff = yes	
			add_country_modifier = { name = overextended_domene_size_3  duration = -1 hidden = yes }	
		}
		else = {	
			remove_domene_overextension_debuff = yes	
		}	
	}
}
society_choo.5 = {
	type = country_event
	title = "society_choo.3"
	desc = "society_choo.3"
	hidden = yes

	trigger = {  
		NOT = { government = feudal_monarchy } 
		OR = { 
			has_country_modifier = overextended_domene_size_1  
			has_country_modifier = overextended_domene_size_2
			has_country_modifier = overextended_domene_size_3 
		}
	}
	
	immediate = { 
		remove_domene_overextension_debuff = yes 
	}
}
	
#protectors of the weak
society_choo.6 = {
	type = country_event
	hidden = yes

	trigger = {  	
		has_variable = protectors_of_the_weak
		any_countries_at_war_with = {
			NOT = { religion = root.religion } 
		}
		NOT = { has_country_modifier = protectrs_of_the_weak }	
	}

	immediate = { 
		add_country_modifier = { name = protectrs_of_the_weak duration = -1 } 
	}	
}
	
society_choo.7 = {
	type = country_event
	hidden = yes

	trigger = {  
		has_variable = protectors_of_the_weak
		war = no
		NOT = { has_country_modifier = protectrs_of_the_weak }
	}
	
	immediate = {
		remove_country_modifier = protectrs_of_the_weak 
	}	
}
#nomadic governmet
society_choo.8 = {
	type = country_event
	hidden = yes

	trigger = {  
		government = nomadic_tribe
	}
	
	immediate = { 
		assing_proper_nomadic_authority_modifier = yes
	}	
}	
	
society_choo.9 = {
	type = country_event
	hidden = yes

	trigger = {  
		NOT = { government = nomadic_tribe }
		has_nomadic_authority_modifier = yes
	}
	
	immediate = { 
		remove_all_nomadic_authority_modifiers = yes
	}	
}	
	
	